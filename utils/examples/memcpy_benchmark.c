#include <rig.h>
#include <stdio.h>
#include <time.h>
#include <string.h>
#include "../../trunk/src/str_ops/str_ops.c"

#define random_1k \
	"\xFD\xEA\x6D\x92\xF5\x1E\x75\x8B\x9E\x35\xF4\xBC\x44\xA2\xE3\x78\x6C\x57\x57\x2E\xB6\x23\x9D\x15\x40\x6A\x6E\xF3 \
	\x07\xA1\x7C\x77\xF4\x57\x76\x9A\xA4\xB3\x3F\x12\x0B\x76\x3B\xB6\x1A\xC7\x7A\x37\xB5\xF9\xBA\xD4\xD9\x9B\xF9\x60 \
	\xCC\xCF\xDB\xF9\xBE\xFC\x83\x11\xD5\x59\x16\x1D\x3C\xD7\x47\x6D\x8F\xA9\x5F\x84\x2C\x8D\xE7\x96\x7C\x6C\x20\xEF \
	\xAF\xAA\xBD\x69\x45\x6F\xED\xC1\xFE\x1A\xCE\x42\x12\x5C\xF4\x5F\x87\x46\x74\x2B\x96\x7C\xF2\x0B\xD6\x3E\x51\xB0 \
	\x22\x22\x60\x2F\x3C\x9F\x19\xE2\x44\x43\x37\x6B\x85\xC1\x0E\x62\x3A\xA8\x41\x0F\xDE\x99\x7B\x6D\xD6\x05\x36\x33 \
	\x0F\x31\x8A\x5A\x51\x1E\xA7\x65\x39\x1A\x4A\x2A\x54\x4F\x67\x9B\x39\xD5\x46\x27\x3A\xE1\x7D\x8F\x53\x71\x0D\xA6 \
	\x9A\xB9\xA8\x1E\xC9\x88\xAF\x6C\x55\xB6\x6D\xEE\x50\x8A\xE5\x79\xDE\x4B\x89\x01\x75\x5C\x89\x3C\x65\x9F\xD6\x3E \
	\xC7\xC9\x6F\xC3\xCB\xD2\x3A\xDA\xB7\x9A\x88\x20\xC9\x5D\x17\x88\x26\xB7\xDB\xCD\xB3\x03\xE4\xC6\xAA\x6A\x5B\x8E \
	\xF9\x68\x61\x42\xC4\x69\x4D\x75\x96\x9F\xEC\xC0\x39\xDC\x6E\x5C\x6D\x8C\xB5\xFE\x41\x61\x83\xD7\x62\x13\x17\xB0 \
	\xC7\x90\xE9\x41\xC4\x21\x37\xF7\x9B\xAF\xFA\xF6\xEB\x0A\xE9\x86\x4F\x86\xAB\xAC\x05\x9B\x0B\xCD\x6E\xD2\x2B\xD7 \
	\x60\x9B\xA6\x79\xEA\xA2\xC3\xAE\x20\x1B\x8D\x82\x81\x61\x81\x69\x0E\x10\x2B\xE0\x6B\xC7\x1D\xE6\xE7\x89\xBF\xD7 \
	\x4B\xEE\xCB\xC3\xD0\xD4\x47\x04\x33\x4C\xA2\x42\xB0\xAD\xED\x1E\x4E\xC3\xFE\xBA\x01\xD8\x03\xD4\x5D\x20\x87\x02 \
	\xC0\x85\x96\x6F\xB4\x88\x24\xE4\xC0\xEF\xA1\x99\xE5\x15\xBA\xC2\xD0\x5A\xD3\x33\xC5\xF6\x3D\x8F\x7E\x87\x6F\xB5 \
	\xF4\xC0\xD3\x80\x10\xAC\x7D\x68\x84\xB5\x0D\x89\x61\xC1\x18\x74\x60\x34\x90\x99\x80\x3D\x95\xD2\xE8\x64\x48\xAD \
	\x71\x7C\xA7\xAA\x2A\x0A\xC3\x39\x6F\x1A\xF2\x55\xBC\x29\x4F\x43\x12\x44\x33\x1B\x75\xF2\x1E\xDD\x22\xC2\xE8\xEC \
	\xA6\xE2\xD3\xA9\xF9\x04\xC0\xE2\x6B\x72\xB4\x19\x78\x93\xF0\x6D\x38\xFB\xCB\x0A\x20\x85\x94\xFD\x6A\x02\x68\xE4 \
	\x53\x72\x1E\xD9\x37\x5F\xC4\x75\xC9\x94\xFF\x54\x28\x19\xFD\xF2\xF2\xA5\x5F\x66\x7B\x33\x6B\x02\x5E\xBF\x16\xD1 \
	\x71\x3D\x60\x1E\x14\x59\xC7\x43\xE6\xE9\x5B\x69\x22\xE1\xC2\x5E\x79\xAE\x8D\x75\xE1\xC2\xDB\x5D\x37\xD9\x7C\xAF \
	\x96\x34\x4C\x38\x65\x56\x5A\x12\xDD\xAC\xC7\xC5\xF6\x34\x97\x54\xFA\xF4\x44\x72\x61\xF1\x2F\xD5\x5F\x07\xAC\xBC \
	\x08\x85\x82\x62\xA4\x81\x9B\xE4\xAE\x01\x9E\x86\xD9\xFD\x6E\x87\xF0\x0A\x57\x10\xEC\xE9\x4F\xE7\x9C\xE9\x96\x7A \
	\x13\x89\xDD\x0A\xAE\x5B\x93\x88\xDC\xEB\xDE\x58\x34\x9C\xBE\x3C\x01\xEA\x6A\x8D\x03\x6D\x16\xB0\xDA\xAF\x7E\x2C \
	\xF5\x9A\x8C\x0C\xDC\x47\x0F\x72\xB9\x5D\xE9\xF8\x29\xFF\x04\x60\x4C\x67\x92\x31\x06\xB9\x8A\x7E\x90\x0F\x39\xB2 \
	\x59\xF9\x39\x02\x5C\x29\xBE\x6A\x6B\x05\x75\xE5\x9B\xE0\x28\xE5\x50\x40\x8B\xD8\x76\x41\xB4\x70\x59\xEF\xBE\xE2 \
	\x46\x09\x83\x09\x91\x4A\xE3\xA1\x22\x96\xB0\x55\xDF\x90\x47\xBE\x04\xFC\xB9\xDF\xE6\x78\x58\xB0\xB0\x50\x28\x91 \
	\x35\xF6\xFC\xD3\x94\x8F\xC0\xE9\xAE\x65\xAC\xC7\x9A\x9E\x6C\xF0\x54\x54\x9E\xA2\xCE\xAC\xC6\x4E\xEE\xAB\x58\x18 \
	\xFD\x50\x81\xEE\x80\x3E\xC5\xFD\xE4\x35\x9D\x7A\x75\x2C\x05\x0F\xBD\xA0\x5B\xC6\x69\x6C\xC6\x50\x0D\x36\xD8\xD6 \
	\x03\x5D\xEB\x96\xB7\x59\xAF\xD1\x9F\x49\x3B\x6D\xD8\xE6\xF8\x35\x66\xE0\x6C\xD5\x66\xF3\xEB\x2C\x85\x37\xA3\xC9 \
	\x5C\xB9\x13\x67\x2A\xAB\xD6\xC0\xB7\xE2\xF2\x0F\xE8\x6A\x77\x4C\x7E\x15\x5F\x63\x32\xA0\x7E\x59\x07\x0F\xB3\x45 \
	\xA1\x5C\xC3\x85\x21\x5A\x10\x2D\x60\xD8\x93\xD3\xEC\x09\x9F\x6E\x45\x13\x89\x86\xD5\xD0\xC2\x54\x3C\x21\x8F\xF9 \
	\x83\xE0\x8B\x3C\xBD\x3C\x1B\x38\x34\x22\xD5\x96\xF8\xC1\xF3\xC9\x8D\x51\x6F\x7E\x36\x04\xA1\x7C\xD0\xEE\x21\x83 \
	\xF0\xAA\xA4\x8B\x3A\x80\x0D\x7A\x9E\xCA\x4C\x85\xF4\xA4\x0F\x43\x90\xE4\x02\x24\x52\x26\xB6\x3C\x60\xA3\x26\x9D \
	\xF1\xA4\x13\x69\x9A\x1C\x4F\xBD\xD3\x30\xB2\x57\x49\x49\x11\x24\x6C\x0B\x5F\xA2\x91\xE6\x43\x1C\xC7\x4D\xBF\xCA \
	\x05\x7E\xAC\x3A\x6E\x05\x5B\xAD\xC7\xE3\xEA\xB2\x78\xEE\x78\x22\x90\xAC\x54\xA6\x21\x0A\xC9\xC0\xB4\x75\x9E\xD8 \
	\x0F\x31\x6E\x06\x20\xD7\x85\x6D\xDD\xB0\x66\xA2\x1D\xE7\x58\xE3\x34\x72\xB7\x40\x20\x78\xBF\x1E\x75\x8E\x4C\x6C \
	\x45\x75\x2F\xCB\x5F\x70\x2E\x24\x3C\xD7\x3E\x1F\x19\x9D\x05\xE5\xCB\xB3\xC9\xFE\x62\xB7\x0D\x7F\x40\x9B\x3B\x8D"

int main(void) {
	struct timespec s_time, e_time;

	uint8_t src[] = random_1k;
	size_t len = sizeof(random_1k) - 1;
	uint8_t dest[len];

	if (clock_gettime(CLOCK_REALTIME, &s_time)) {
		fprintf(stderr, "clock_gettime failed");
		exit(1);
	}

	for (size_t i = 0; i < (10 * 1024 * 1024); i++) {
		str_ops_copy(dest, src, len);
	}

	if (clock_gettime(CLOCK_REALTIME, &e_time)) {
		fprintf(stderr, "clock_gettime failed");
		exit(1);
	}

	printf("\nMEMCPY STATS\n");
	double tt = (double)(e_time.tv_sec - s_time.tv_sec) + ((double)(e_time.tv_nsec - s_time.tv_nsec) / 1000000000.0);
	printf("time elapsed: %.12f\n", tt);
	printf("throughput: ~ %.2f Gbit/s\n\n", (80.0 / tt));

	return (0);
}
